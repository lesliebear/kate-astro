---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Video from "../../components/Video/Video";

export async function getStaticPaths() {
    let data = await fetch("http://localhost:3000/api/media?limit=500");
    let videos = await data.json();

    return videos.docs.map((post) => {
        return {
            params: {slug: post.title},
            props: {
                vidIDs: post.videoList, 
                vidID: post.vidID, 
                role: post.role,
                hasRental: post.rentalLink,
                press: post.press,
            },
        };
    });
}

const { slug } = Astro.params;
const { vidIDs, vidID, role, hasRental, press } = Astro.props;
---

<BaseLayout>
    <Video
        vidIDs={vidIDs}
        vidID={vidID}
        title={slug}
        role={role}
        hasRental={hasRental}
        press={press}
        client:load
    />
</BaseLayout>
